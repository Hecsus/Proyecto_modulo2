<h1><%= producto ? 'Editar' : 'Nuevo' %> producto</h1>
<form action="<%= producto ? '/productos/' + producto.id + '/editar' : '/productos/nuevo' %>" method="POST">
  <div class="mb-3">
    <label class="form-label">Nombre</label>
    <input type="text" name="nombre" class="form-control" value="<%= producto ? producto.nombre : '' %>">
  </div>
  <div class="mb-3">
    <label class="form-label">Descripción</label>
    <textarea name="descripcion" class="form-control"><%= producto ? producto.descripcion : '' %></textarea>
  </div>
  <div class="row">
    <div class="col-md-4 mb-3">
      <label class="form-label">Precio</label>
      <input type="number" step="0.01" name="precio" class="form-control" value="<%= producto ? producto.precio : '' %>">
    </div>
    <div class="col-md-4 mb-3">
      <label class="form-label">Stock</label>
      <input type="number" name="stock" class="form-control" value="<%= producto ? producto.stock : '' %>">
      <div class="form-text">Cantidad actual disponible</div>
    </div>
    <div class="col-md-4 mb-3">
      <label class="form-label">Stock mínimo</label>
      <input type="number" name="stock_minimo" class="form-control" value="<%= producto ? producto.stock_minimo : '' %>">
      <div class="form-text">Umbral mínimo antes de reponer</div>
    </div>
  </div>
  <div class="mb-3">
    <label class="form-label">Localización</label>
    <select name="localizacion_id" class="form-select">
      <option value="">Seleccione...</option>
      <% localizaciones.forEach(l => { %>
        <option value="<%= l.id %>" <%= producto && producto.localizacion_id == l.id ? 'selected' : '' %>><%= l.nombre %></option>
      <% }) %>
    </select>
  </div>
  <div class="mb-3">
    <label class="form-label">Categorías</label>
    <select name="categorias" multiple class="form-select">
      <% categorias.forEach(c => { %>
        <option value="<%= c.id %>" <%= producto && producto.categorias && producto.categorias.includes(c.id) ? 'selected' : '' %>><%= c.nombre %></option>
      <% }) %>
    </select>
  </div>
  <div class="mb-3">
    <label class="form-label">Proveedores</label>
    <select name="proveedores" multiple class="form-select">
      <% proveedores.forEach(p => { %>
        <option value="<%= p.id %>" <%= producto && producto.proveedores && producto.proveedores.includes(p.id) ? 'selected' : '' %>><%= p.nombre %></option>
      <% }) %>
    </select>
  </div>
  <% if (errors.length) { %>
    <div class="alert alert-danger">
      <ul class="mb-0">
        <% errors.forEach(e => { %><li><%= e.msg %></li><% }) %>
      </ul>
    </div>
  <% } %>
  <button class="btn btn-primary">Guardar</button>
</form>
